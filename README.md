# 1. 프로젝트 명 : 이산 이벤트 시뮬레이션 프로젝트

이산 이벤트 시뮬레이션은 모든 시간의 진행이 이벤트의 발생에 의해 이루어진다. 이벤트가 발생하면 시간이 진행된다. 많은 이벤트가 발생할 경우 이 이벤트들은 시간적으로 먼저 발생한 이벤트가 먼저처리 되어야 한다. 이를 위해 우선순위 큐를 이용하여 이벤트를 저장하고 이벤트의 발생 시각을 우선순위로 하여 이벤트를 처리하는 시뮬레이션 개발

목표:
- 최소 히프(heap)를 이용한 아이스크림 가게 시뮬레이션 프로그램 구현
- 아이스크림 가게에 손님이 들어오고 나가는 과정을 시뮬레이션 하는 것
- 몇 개의 의자를 비치해야 이익을 극대화할 수 있는지 시뮬레이션

제약조건:
- 아이스크림 가게의 의자가 파라미터
- 손님이 도착했을 때 의자가 없으면 그냥 나간다.
- 아이스크림 가게에서 발생하는 이벤트

 - (Arrival) 손님이 도착하는 이벤트
 - (Order) 손님이 주문하는 이벤트
 - (Leave) 손님이 가게를 떠나는 이벤트

각각의 이벤트들은 이벤트가 발생한 시각과 손님을 가짐
도착한 손님은 랜덤한 시간 후에 주문 이벤트를 발생시킴
손님은 주문을 하고 나서 랜덤한 시간 후에 가게를 떠나는 이벤트를 발생

동작:
- 시뮬레이션 처음부분에서 일정 시간 동안 손님이 도착하는 이벤트를 몇 개 발생시켜 우선
순위 큐에 저장 
- 우선순위 큐는 이벤트가 발생한 시각 순으로 이벤트를 꺼내어 처리하고 우선순위 큐에 더 이상 이벤트가 없으면 프로그램을 종료
- 이벤트는 각각의 종류에 따라 다르게 처리한다.
- 손님이 도착하는 이벤트 처리 : 먼저 손님의 숫자와 현재 남아 있는 의자를 비교하여 남아
있는 의자가 더 많으면 손님을 받고 남아 있는 의자의 수는 손님의 숫자만큼 줄어든다.
만약 의자가 더 적으면 손님은 주문을 하지 않고 나간다.

- 주문 이벤트 처리 : 손님의 숫자대로 주문을 받고 잠시 후에 손님들이 떠나는 이벤트를 발
생시킨다.
- 손님이 떠나는 이벤트 : 떠나는 숫자만큼 남아 있는 의자의 개수를 증가

손님들이 가게에 들어와서 항상 일정한 시간 후에 주문을 하거나 일정 시간 후에 가게를 나
가는 것은 의미가 없으므로 손님이 도착하는 시간 손님의 숫자, 주문하는데 걸리는 시간, 가게에 머물러 있는 시간은 모두 랜덤하게 발생 - <세 개의 이벤트는 하나의 우선순위 큐
에서 관리되면 시간이 앞선 것을 먼저처리 한다.>

# 2. 데이터 자료형 설명

element 구조체 : 이벤트 종류와 시간, 고객 수를 저장 할 수 있는 구조체, 단순한 저장의 역할이므로 구조체로 구현

eventinfo 클래스 : 시뮬레이션과 이벤트 전체를 관리하는 총괄 클래스, 빈자리 수, 순익, element 구조체, 하나의 히프를 가지고 있고 자리 수 감소, 주문에 다른 순익 증가, 고객 떠나면 빈자리 수 증가, 히프에서 뽑아오는 이벤트 처리, 시뮬레이션을 위한 가상 이벤트 시뮬레이션 함수가 있다.

Heap 클래스 : 히프 구조를 구현하고 히프에 삽입, 삭제와 초기화, 비었는지 확인하는 함수가 있다.

EVENTNUM enum : 이벤트의 종류를 구별하는 상수

# 3. 문제해결을 위한 알고리즘 설명

최초에는 히프를 초기화하고 시뮬레이션을 위해 히프에 몇 개의 이벤트를 무작위로 생성하여 저장해둔다. 이 때 손님이 입장해야 주문과 퇴장이 있을 수 있으므로 초기 생성은 모두 손님 입장의 상수 값으로 저장하고 이벤트 실행 시 시간이 진행되도록 무작위 시간 값을 저장, 무작위 고객 수를 저장한다. 이 부분을 element 구조체로 만들고 저장했다. 이 구조체를 최소 히프에 저장하는 것이다. 

저장 시에는 최소 히프에 새 노드를 삽입하는 방식이고 이는 새 노드를 입력하면 히프 사이즈/2 -> 즉, 부모 노드와 비교하여 이보다 작으면 부모 노드와 교환하고 한 레벨 씩 상승, 그 후 위치를 찾으면 해당 노드를 입력한다. 이 과정을 몇 번 반복하여 히프에 이벤트를 몇 개 등록한다.

그 후 시뮬레이션을 히프가 빌 때 까지 반복한다. 처음에 히프를 삭제하면서 그 노드를 꺼내온다. 최상위 이벤트부터 꺼내올 것이고 그것을 시뮬레이션 함수에 입력하여 시뮬레이션을 히프가 빌 때 까지 반복한다. 이 함수를 호출할 때 마다 진행 시간을 보여주고 입력한 구조체의 이벤트 종류에 따라 진행한다.
고객 도착 시에는 자리가 비었는지 확인하는 함수로 자리가 비었는지 확인하고 자리가 비었으면 새로 저장할 노드에 이벤트 값은 주문으로 주고 주문 수량은 랜덤, 고객 수는 떠나는 것이 아니므로 그 수를 그대로 저장하고 이 부분을 노드로서 히프에 저장한다.

주문 시에는 고객 수만큼 주문 함수를 호출하고 입력 값은 무작위이다. 주문 수량을 출력해주고 순익에 더한다. 이익 비율은 임의로 20%로 정했다. 그 다음 다음 이벤트 값을 떠나는 이벤트로 하고 다음에 떠날 수를 무작위로, 아직 떠나지는 않았으므로 고객 수를 그대로 저장한다. 이를 히프에 이벤트로 저장한다.

고객이 떠날 때는 고객 수를 떠나는 함수에 입력하고 떠나는 함수는 그 수를 출력하여 떠났음을 보여주고 그 수만큼 빈자리 수를 더하면 된다. 이를 진행하다보면 언젠가 히프가 비게 될 것이고 이 때 반복이 종료, 프로그램 종료 전에 최종 순이익을 보여주면 된다.
